# mattermost-poll
Бот добавляющий функционал голосования в Mattermost.

# Функционал
Добавив бота в команду, можно вызывать его командами:
* `!help` - выводит информацию о доступных коммандах.

* `!poll_start "[question]" "[option1]" "[option2]" ...` - создает голосование и выводит его ID. 
ВАЖНО: вопрос и варианты ответа должны быть в кавычках.

* `!poll_vote [pollID] [vote]` - регистрирует голос пользователя в голосовании. Параметр \[vote\] это номер варианта ответа.

* `!poll_results [pollID]` - выводит результаты голосования.

* `!poll_close [pollID]` - создатель голосования может закрыть его.

* `!poll_delete [pollID]` - создатель голосования может удалить его.

Возможно придется обновить страницу в браузере чтобы увидеть сообщение бота.

# Инструкция по установке
## Требования
Убедитесь что у вас установлены Docker и Docker Compose.
## Клонирование репозитория 
Склонируйте репозиторий
## Создание `.env`
Скопируйте `example.env` в файл `.env` и заполните их другими данными если нужно.
## Установка Mattermost
### Mattermost уже установлен
Если у вас уже установлен Mattermost, в `.env` поставьте соответствующее значение `MM_SERVER`. Убедитесь что у вас есть права для создания бота и добавления его в команду.
### Mattermost не установлен
В `.env` оставьте значение `MM_SERVER` как в `example.env`. И запустите
```bash
docker-compose -f docker-compose.only-mattermost.yml up --build
```
Mattermost будет находиться по адресу `http://localhost:8065`. Зайдите туда и зарегистрируйтесь.
## Создание бота
Создайте бота по [этой](https://developers.mattermost.com/integrate/reference/bot-accounts/) инструкции и дайте ему при создании права на создание постов. Добавьте его в команду в которой будет использоваться бот. 

Заполните соответствующими значениями переменные окружения `MM_USERNAME`, `MM_TEAM`, `MM_TOKEN` в `.env`.
## Запуск
После выполнения всех предыдущих пунктов запустите
```bash
docker-compose up --build
```
Для завершения работы нажмите `Ctrl+C`.